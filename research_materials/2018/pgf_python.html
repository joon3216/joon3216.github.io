<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Junkyu Park" />


<title>Using pgf and DFT: Python implementation</title>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-139050237-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-139050237-1');
</script>
<!-- A new navigation bar style settings -->
<style type="text/css">
    /* at the top */
    #navbar
    {
        position: sticky;
        z-index: 1000; /* new; why: make navbar closest to the observer */
        top: 0;
        left: 0;
        padding: 0; /* old: 10px 25px */
        background: rgba(28, 44, 56, 0.99);
        width: 100%;
        height: 50px;
        box-sizing: border-box;
        border-bottom: 1px solid #EAEAEB;
        transition: .5s;
    }
    #navbar .logo
    {
        float: left;
    }
    #navbar .logo img
    {
        height: 30px;
        /* new: margin; why: so that in header, padding can be 0 */
        /* note: header nav ul li a has margin 20px on left and right, 
        so here I let the right margin of img to be 5px so that it matches
        with the left margin 25px */
        /* edit: 5 to 20px since it looks nicer */
        margin: 10px 20px 10px 25px; 
    }
    #navbar nav
    {
        float: right; /* old: left; why change: to give a more standard look */
        margin: 0 27.5px 0 0;
    }
    #navbar nav ul
    {
        margin: 0;
        padding: 0;
        display: flex;
    
    }
    #navbar nav ul li
    {
        padding: 0;
        list-style: none;
        position: relative;
        /* new: margin and padding; why: header padding is now 0 */
        margin: 0;
        padding: 8.5px 0 8.5px 0;
    }
    /* new; why: texts with arrow on the right gets more space  */
    #navbar nav ul li.sub-menu
    {
        /* why 8.5px: that's the value in header nav ul li padding */
        padding: 8.5px 27.5px 8.5px 0;
        padding-bottom: 12px;
        /* new; why: to make dropdown menu available once the mouse is on the menu item that it belongs, and to not affect other menu items that is not of class sub-menu */
    }
    
    /* new; why: prepare in case of text-align: right */
    /* commented out because news menu is now gone in navbar*/
    /* #navbar nav ul li#news
    {
        padding: 8.5px 0;
        margin: 0;
    } */
    
    /* new; why: this potentially has a different background color */
    #navbar nav ul li#home
    {
        background-color: rgba(21, 92, 148, .9); /* old: rgba(28, 44, 56, 0); */
        border-bottom: 1px solid #EAEAEB;
        margin: 0 0 .5px 0;
    }
    
    #navbar nav ul li.sub-menu:before
    {
        content: '\f0d7'; /* &#9660 ▼ nabla */
        font-family: fontAwesome; /* old: sans-serif */
        font-size: 16pt;
        position: absolute;
        /*line-height: 30px;*/
        color: #ffffff;
        top: 7pt;
        right: 22.5px;
        cursor: pointer;
    }
    #navbar nav ul li.active.sub-menu:before
    {
        content: '\f0d8';  /* &#9650 ▲ Delta */
        font-family: fontAwesome; /* new */
        font-size: 16pt;
        position: absolute;
        color: #666;
        top: 7pt;
        right: 22.5px;
        cursor: pointer;
    }
    #navbar nav ul li ul
    {
        position: absolute;
        left: 0;
        top: 50px; /* controls the box position of dropdown menus */
        background: rgba(57, 143, 209, 0.99);
        display: none;
    }
    #navbar nav ul li.active ul
    {
        display: block;
    }
    
    /* new; why: make dropdown menu box fit to the menu above */
    /* padding: 0; is for slimmer individual dropdown menu items */
    /* old */
    #navbar nav ul li.sub-menu ul li
    {
        display: block;
        width: 200px;
        padding: 5px 0;
    }
    
    /* new: header nav ul li ul li a */
    /* why: giving an indentation */
    #navbar nav ul li ul li a
    {
        margin: 0 40px;
    }
    
    /* header nav ul li#projects.sub-menu ul li
    {
        display: block;
        width: 115px;
        padding: 0;
    }
    header nav ul li#rm.sub-menu ul li
    {
        display: block;
        width: 197px;
        padding: 0;
    } */
    
    #navbar nav ul li a
    {
        height: 30px;
        line-height: 30px;
        padding: 0; /* old: 0 20px, and margin didn't exist; why change: to make text the only clickable object */
        margin: 0 20px;
        color: #ffffff;
        text-decoration: none;
        text-shadow: none; /* new; why: to be compatible with the Tactile theme */
        /*display: block;*/
    }
    
    /* new: news; why add: to make News go to the right */
    /* commented out because the same effect is achieved by having 
    header nav ul li.sub-menu padding: 8.5px 15px 8.5px 0; */
    /* header nav ul li.news
    {
        margin: 0 0 0 20px;
    } */
    
    /* new: rm; why: to make r_m go to the right */
    /* commented out because the same effect is achieved by having 
    header nav ul li.sub-menu padding: 8.5px 15px 8.5px 0; */
    /* header nav ul li#rm
    {
        margin: 0 0 0 20px;
    } */
    
    
    #navbar nav ul li a:hover
    {
        color: #666;
    }
    
    /* new: header nav ul li:hover ul, why: to make dropdown menu appear whenever mouse is above */
    #navbar nav ul li:hover ul
    {
        display: block;
    }
    
    #navbar nav ul li:hover ul li:hover
    {
        background-color: rgba(5, 83, 143, 0.99);
    }
    
    .menu-toggle
    {
        color: #ffffff;
        float: right;
        line-height: 30px;
        font-size: 24px;
        cursor: pointer;
        display: none;
        text-shadow: none;
    }

    ul.social-network
    {
        text-align: center;
        padding: 0;
        margin: 5px 0;
    }

    ul.social-network li
    {
        display: inline;
        list-style: none;
        padding: 0 5px;
    }
    @media (max-width: 800px) /* old1: 991px; old2: 721px */
    {
        /* at the top */
        #navbar
        {
            padding: 0; /* old: 10px 25px */
        }
        .menu-toggle
        {
            display: block;
            margin: 10px 25px /* new; why: header padding is now 0 */
        }
        #navbar nav
        {
            /*display: none;*/
            overflow: auto; /* new; why: when mobile, make sure scroll shows up if vertical space not sufficient to display every element of nav */
            position: absolute;
            width: 100%;
            height: calc(100vh - 50px);
            background: rgba(28, 44, 56, 0.99);
            top: 50px;
            left: -100%;
            transition: .5s;
        }
        #navbar nav.active
        {
            left: 0;
        }
        #navbar nav ul
        {
            display: block;
            /*text-align: center;*/
        }
    
        /* new; why: to make sure it doesn't appear in mobile view;
        I don't want to see it in mobile since the logo already directs you
        to home. Adding home in mobile seems a clutter.
        */
        #navbar nav ul li#home
        {
            display: none;
        }
    
        #navbar nav ul li a
        {
            border-bottom: 1px solid rgba(255, 255, 255, .5);
            height: 50px;
            line-height: 50px;
            padding: 0 20px;
        }
        #navbar nav ul li.active ul
        {
            position: relative;
        }
        #navbar nav ul li ul li
        {
            width: 100%;
        }
    
        /* new: header nav ul li.sub-menu */
        /* why: so that dropdown menus fill the entire row in mobile */
        #navbar nav ul li.sub-menu
        {
            padding: 8.5px 0;
        }
    
        #navbar nav ul li.sub-menu:before
        {
            content: '+'; /* old: &#9660 nabla */
            font-size: 20pt;
            font-family: sans-serif;
            height: 40px;
            position: absolute;
            /* line-height: 30px; */
            color: #ffffff;
            width: 20px;
            /* top: 5pt; */
            right: 25px;
            cursor: pointer;
            bottom: 18px;
        }
        #navbar nav ul li.active.sub-menu:before
        {
            content: '–';  /* new: &#9650 Delta */
            font-size: 20pt;
            /* top: 5pt; */
            right: 25px;
            /* line-height: 30px; */
            cursor: pointer;
            position: absolute;
            color: #666;
            bottom: 18px;
            height: 40px;
        }
        #navbar nav ul li ul
        {
            position: absolute;
            left: 0;
            top: 0px; /* controls the box position of 2018 and 2019 under Research materials */
            background: rgba(57, 143, 209, 0.99);
            display: none;
        }
    
        /* new: hover and active
        why: do not display drop down menus when mouse is over it in mobile, 
        but display them when plus signs are clicked */
        #navbar nav ul li:hover ul
        {
            display: none;
        }
        #navbar nav ul li.active ul
        {
            display: block;
        }
    
        /* new; why: no background color change in dropdown menu when hovering over in mobile */
        #navbar nav ul li.sub-menu:hover ul li:hover
        {
            background-color: rgba(5, 83, 143, 0);
        }
    
        /* new: News; why: to make News align with the others in mobile */
        /* commented out since Research Materials uses different method
        to get more space on its right (header nav ul li.sub-menu padding) */
    
        /* header nav ul li.news
        {
            margin: 0;
        } */
        /* new: rm; why: to make rm align with the others in mobile */
        /* commented out for the same reason */
        /* header nav ul li#rm
        {
            margin: 0;
        } */
    
        /* while scrolling */
        #navbar.black nav ul li a:hover
        {
            color: #666;
        }
    }
    
    /* while scrolling */
    #navbar.black
    {
        background: rgba(21, 92, 148, .9);
    }
    #navbar.black nav ul li#home
    {
        background-color: rgba(28, 44, 56, 0);
        /* border-bottom: 1px solid #EAEAEB;
        margin: 0 0 .5px 0; why commented: unnecessary */
        transition: .2s;
    }
    #navbar.black nav ul li a:hover
    {
        color: darkgrey;
    }
    #navbar.black nav ul li.active.sub-menu:before
    {
        color: darkgrey;
    }
    </style>
    
    <!-- 1. Navigation bar color change as one scrolls -->
    <!-- by adding a new class="black" while scrolling -->
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script type="text/javascript">
        $(window).on('scroll', function(){
            if ($(window).scrollTop()){
               navbar.classList.add('black');
               /* old: $('header').addClass('black'); */
            }
            else
            {
                navbar.classList.remove('black');
                /* old: $('header').removeClass('black'); */
            }
        })
    </script>
    
    <!-- 2. Navigation bar slides from the left in mobile -->
    <!-- 3. Only one dropdown menu at a time will appear -->
    <script type="text/javascript">
        $(document).ready(function(){
            $('.menu-toggle').click(function(){
                $('nav').toggleClass('active')
            })
            $('ul li').click(function(){
                $(this).siblings().removeClass('active');
                $(this).toggleClass('active');
            })
        })
    </script>
    
    <!-- Using caret down and up symbols -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
<link rel="icon" href="../../style/all_orange_jp.png">


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

/* A workaround for https://github.com/jgm/pandoc/issues/4278 */
a.sourceLine {
  pointer-events: auto;
}

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link rel="stylesheet" href="pgf_python_files/style.css" type="text/css" />





</head>

<body>


<!-- A new navigation bar -->
<div id="navbar">
    <div class="logo">
        <a href="../../index.html"><img src="../../style/all_orange_jp.png"></a>
    </div>
    <nav>
        <ul>
            <li id="home">
                <a href="../../index.html">Home</a>
            </li>
            <li class="sub-menu" id="projects">
                <a href="../../projects.html">Projects</a>
                <ul>
                    <li>
                        <a href="../../projects/2019.html">2019</a>
                    </li>
                    <li>
                        <a href="../../projects/2020.html">2020</a>
                    </li>
                </ul>
            </li>
            <li class="sub-menu" id="rm">
                <a href="../../research_materials.html">Research materials</a>
                <ul>
                    <li>
                        <a href="../../research_materials/2018.html">2018</a>
                    </li>
                    <li>
                        <a href="../../research_materials/2019.html">2019</a>
                    </li>
                    <li>
                        <a href="../../research_materials/2020.html">2020</a>
                    </li>
                </ul>
            </li>
            <!-- <li id="news">
                <a href="../../news.html">News</a>
            </li> -->
            <li>
                <a href="../../files/resume_junkyu_park.pdf">Resume</a>
            </li>
        </ul>
    </nav>
    <div class="menu-toggle">
        <i class="fa fa-bars" aria-hidden="true"></i>
    </div>
</div>


<section class="page-header">
<h1 class="title toc-ignore project-name">Using pgf and DFT: Python implementation</h1>
<h4 class="author project-author">Junkyu Park</h4>
</section>



<section class="main-content">
<p>The following Python packages/functions are used:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1"><span class="im">from</span> datetime <span class="im">import</span> datetime <span class="im">as</span> dt</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="im">from</span> scipy.optimize <span class="im">import</span> fmin</a></code></pre></div>
<p>This note is a continuation from <a href="pgf.html">Evaluating a hard-to-evaluate pmf using pgf and DFT</a> under 2018: Statistical Computation.</p>

<div id="TOC" class="toc" style="padding:2rem 2rem 0 0;">
<ul style="list-style:none;">
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#the-four">2. The Four</a><ul>
<li><a href="#rpmf-comparison-with-its-r-equivalent"><code>rpmf</code> comparison with its R equivalent</a></li>
</ul></li>
<li><a href="#session-info">Session info</a></li>
<li><a href="#related-pages">Related pages</a></li>
</ul>
</div>
&nbsp;

<div id="introduction" class="section level1">
<h1>1. Introduction</h1>
<p>This note concerns with a replication of R functions written in the <a href="pgf.html">previous note</a>. Four functions — <code>dX</code>, <code>csum_N</code>, <code>dpmf</code>, and <code>rpmf</code> — will be written in Python, and the same plots will be produced using <code>matplotlib.pyplot</code>.</p>
</div>
<div id="the-four" class="section level1">
<h1>2. The Four</h1>
<p>Details of the following four functions are written in the <a href="pgf.html">previous note</a>.</p>
<p>First, <code>dX</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" title="1">npmap <span class="op">=</span> <span class="kw">lambda</span> func, <span class="op">*</span>iterable: np.array(<span class="bu">list</span>(<span class="bu">map</span>(func, <span class="op">*</span>iterable)))</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">def</span> dX(x):</a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="co">&#39;&#39;&#39;(number or *iterable) -&gt; number or np.array</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">    </span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">    Return the probability assigned for x, defined by the following pmf:</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">    p(0) = .05, p(1) = p(3) = p(4) = .1, p(2) = .075, p(5) = .575, </span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">    and p(x) = 0 otherwise.</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">    </span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">    &gt;&gt;&gt; dX(0)</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">    0.05</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">    &gt;&gt;&gt; dX([2, 5])</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">    array([0.075, 0.575])</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">    &gt;&gt;&gt; dX(np.array([-1, 0, 4]))</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">    array([0.  , 0.05, 0.1 ])</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb2-16" title="16">    </a>
<a class="sourceLine" id="cb2-17" title="17">    <span class="kw">def</span> pX(d):</a>
<a class="sourceLine" id="cb2-18" title="18">        <span class="cf">if</span> d <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb2-19" title="19">            <span class="cf">return</span> <span class="fl">.05</span></a>
<a class="sourceLine" id="cb2-20" title="20">        <span class="cf">elif</span> d <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>]:</a>
<a class="sourceLine" id="cb2-21" title="21">            <span class="cf">return</span> <span class="fl">.1</span></a>
<a class="sourceLine" id="cb2-22" title="22">        <span class="cf">elif</span> d <span class="op">==</span> <span class="dv">2</span>:</a>
<a class="sourceLine" id="cb2-23" title="23">            <span class="cf">return</span> <span class="fl">.075</span></a>
<a class="sourceLine" id="cb2-24" title="24">        <span class="cf">elif</span> d <span class="op">==</span> <span class="dv">5</span>:</a>
<a class="sourceLine" id="cb2-25" title="25">            <span class="cf">return</span> <span class="fl">.575</span></a>
<a class="sourceLine" id="cb2-26" title="26">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb2-27" title="27">            <span class="cf">return</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-28" title="28">    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(x, <span class="st">&#39;__iter__&#39;</span>):</a>
<a class="sourceLine" id="cb2-29" title="29">        <span class="cf">return</span> pX(x)</a>
<a class="sourceLine" id="cb2-30" title="30">    <span class="cf">return</span> npmap(pX, x)</a></code></pre></div>
<p>To code <code>csum_N</code>, we require a <code>fft</code>-equivalent in Python. I will use <code>np.fft.fft()</code> and <code>np.fft.ifft().real</code>. Also, the word <code>lambd</code> is used instead of <code>lambda</code>, since the keyword <code>lambda</code> is used for anonymous functions in Python:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">def</span> csum_N(pmf, support, lambd, eps <span class="op">=</span> <span class="fl">1e-05</span>):</a>
<a class="sourceLine" id="cb3-2" title="2">    <span class="co">&#39;&#39;&#39;(function, np.array, number[, float]) -&gt; np.array</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">        </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">    Preconditions:</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">    1. pmf is a pmf of X_i where the random summation S = X_1 + ... + X_N </span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">       with N ~ Pois(lambd) has 0, 1, ..., M - 1 as the first M element of </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">       its support.</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">    2. pmf is a function whose output is np.array whenever the input is</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">       np.array.</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">    3. support == np.arange(0, l + 1), where l is the largest number of</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">       the support of pmf.</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">    4. lambd &gt; 0</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">    5. 0 &lt; eps &lt; 1</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">        </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">    Return the approximate probability mass function of S, i.e. </span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">    P(S = x | S &lt; M) for some appropriate integer M determined by </span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">    P(S &gt;= M) &lt; eps, where S is the sum of iid X_i&#39;s with </span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">    i = 1, ..., N ~ Pois(lambd), X_i ~ pmf, and X_i&#39;s support is</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">    a subset of np.arange(0, l + 1) (= support) with l being the largest </span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">    element of X_i&#39;s support.</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">        </span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">    &gt;&gt;&gt; def dY(y):</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">    ...     def pY(d):</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">    ...         if d in [1, 4]:</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">    ...             return .25</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">    ...         elif d == 2:</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="co">    ...             return .5</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">    ...         else:</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">    ...             return 0</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">    ...     if not hasattr(y, &#39;__iter__&#39;):</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="co">    ...         return pY(y)</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co">    ...     return npmap(pY, y)</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">    ...</span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="co">    &gt;&gt;&gt; result_Y = csum_N(dY, np.arange(0, 5), 3)</span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">    &gt;&gt;&gt; M_Y = len(result_Y)</span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co">    &gt;&gt;&gt; print(M_Y, sum(result_Y))</span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co">    39 0.9999999999999998</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="co">    &gt;&gt;&gt; result_Y[0:4]</span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">    array([0.04978729, 0.03734044, 0.08868328, 0.05951115])</span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb3-41" title="41">        </a>
<a class="sourceLine" id="cb3-42" title="42">    pmf_vec <span class="op">=</span> pmf(support)</a>
<a class="sourceLine" id="cb3-43" title="43">        </a>
<a class="sourceLine" id="cb3-44" title="44">    <span class="co"># Define the pgf of X_i</span></a>
<a class="sourceLine" id="cb3-45" title="45">    g <span class="op">=</span> <span class="kw">lambda</span> t: npmap(<span class="kw">lambda</span> d: <span class="bu">sum</span>(d <span class="op">**</span> support <span class="op">*</span> pmf_vec), t)</a>
<a class="sourceLine" id="cb3-46" title="46">        </a>
<a class="sourceLine" id="cb3-47" title="47">    <span class="co"># Find M</span></a>
<a class="sourceLine" id="cb3-48" title="48">    Ms <span class="op">=</span> <span class="kw">lambda</span> t: (<span class="op">-</span>lambd <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> g(t)) <span class="op">-</span> np.log(eps)) <span class="op">/</span> np.log(t)</a>
<a class="sourceLine" id="cb3-49" title="49">    M <span class="op">=</span> np.ceil(fmin(Ms, <span class="fl">1.001</span>, full_output <span class="op">=</span> <span class="va">True</span>, disp <span class="op">=</span> <span class="va">False</span>)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb3-50" title="50">    </a>
<a class="sourceLine" id="cb3-51" title="51">    <span class="co"># Append 0&#39;s</span></a>
<a class="sourceLine" id="cb3-52" title="52">    pmf_vec <span class="op">=</span> np.append(pmf_vec, np.zeros(<span class="bu">int</span>(M <span class="op">-</span> <span class="bu">len</span>(pmf_vec))))</a>
<a class="sourceLine" id="cb3-53" title="53">        </a>
<a class="sourceLine" id="cb3-54" title="54">    <span class="co"># Apply DFT and inverse DFT</span></a>
<a class="sourceLine" id="cb3-55" title="55">    gtks <span class="op">=</span> np.fft.fft(pmf_vec)</a>
<a class="sourceLine" id="cb3-56" title="56">    gS_gtks <span class="op">=</span> np.exp(<span class="op">-</span>lambd <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> gtks))</a>
<a class="sourceLine" id="cb3-57" title="57">    pS_tks <span class="op">=</span> np.fft.ifft(gS_gtks).real</a>
<a class="sourceLine" id="cb3-58" title="58">        </a>
<a class="sourceLine" id="cb3-59" title="59">    <span class="cf">return</span> pS_tks</a></code></pre></div>
<p>Let’s check if it works the same as in R:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" title="1">result <span class="op">=</span> csum_N(dX, np.arange(<span class="dv">0</span>, <span class="dv">6</span>), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">M <span class="op">=</span> <span class="bu">len</span>(result)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="bu">print</span>(M, <span class="bu">sum</span>(result))</a></code></pre></div>
<pre><code>## 62 1.0000000000000002</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb6-1" title="1">plt.scatter(np.arange(<span class="dv">0</span>, M), result)</a></code></pre></div>
<pre><code>## &lt;matplotlib.collections.PathCollection object at 0x00000181CA0B9940&gt;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb8-1" title="1">plt.title(<span class="st">&#39;pmf of S&#39;</span>)</a></code></pre></div>
<pre><code>## Text(0.5, 1.0, &#39;pmf of S&#39;)</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb10-1" title="1">plt.xlabel(<span class="st">&#39;x&#39;</span>)</a></code></pre></div>
<pre><code>## Text(0.5, 0, &#39;x&#39;)</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb12-1" title="1">plt.ylabel(<span class="st">&#39;P(S = x)&#39;</span>)</a></code></pre></div>
<pre><code>## Text(0, 0.5, &#39;P(S = x)&#39;)</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb14-1" title="1">plt.show()</a></code></pre></div>
<p><img src="pgf_python_files/figure-html/csum_N_checking-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Yes it does.</p>
<p><code>dpmf</code> is written as follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">def</span> dpmf(x, pmf_vec, support_vec <span class="op">=</span> <span class="va">None</span>):</a>
<a class="sourceLine" id="cb15-2" title="2">    <span class="co">&#39;&#39;&#39;(object or *iterable, *iterable[, *iterable]) -&gt; number or np.array</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co">    </span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">    Preconditions:</span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="co">    1. Elements of x are of the same type as elements of support_vec,</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co">       if support_vec is specified. If support_vec is not specified, then</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co">       x must be a number or an iterable object with numeric elements.</span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">    2. sum(pmf_vec) == 1</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">    3. len(pmf_vec) == len(support_vec) if support_vec is specified.</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">    4. If support_vec is specified, then each element of support_vec </span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">       must be hashable, i.e. element.__hash__ is not None</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">    </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">    Return the probability evaluated at each element of x based on</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">    probabilities in pmf_vec and elements of support_vec if support_vec </span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">    is specified (each element of support_vec is the input that corresponds</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">    to the probability in pmf_vec). If not specified, then support_vec will </span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">    be replaced with np.arange(0, len(pmf_vec)).</span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="co">    </span></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co">    &gt;&gt;&gt; # Example 1</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co">    &gt;&gt;&gt; pmf_eg1 = [0.25, 0.5 , 0.25]</span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="co">    &gt;&gt;&gt; support_eg1 = np.array([1, 2, 4])</span></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="co">    &gt;&gt;&gt; dpmf(1, pmf_eg1, support_eg1)</span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="co">    0.25</span></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="co">    &gt;&gt;&gt; dpmf([3, 4, 6], pmf_eg1, support_eg1)</span></a>
<a class="sourceLine" id="cb15-25" title="25"><span class="co">    array([0.  , 0.25, 0.  ])</span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="co">    &gt;&gt;&gt; dpmf(np.array([3, 4, 6]), pmf_eg1, support_eg1)</span></a>
<a class="sourceLine" id="cb15-27" title="27"><span class="co">    array([0.  , 0.25, 0.  ])</span></a>
<a class="sourceLine" id="cb15-28" title="28"><span class="co">    &gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb15-29" title="29"><span class="co">    &gt;&gt;&gt; # Example 2</span></a>
<a class="sourceLine" id="cb15-30" title="30"><span class="co">    &gt;&gt;&gt; pmf_eg2 = (.25, .4, .35)</span></a>
<a class="sourceLine" id="cb15-31" title="31"><span class="co">    &gt;&gt;&gt; support_eg2 = [&#39;apple&#39;, &#39;orange&#39;, &#39;neither&#39;]</span></a>
<a class="sourceLine" id="cb15-32" title="32"><span class="co">    &gt;&gt;&gt; dfruit = lambda x: dpmf(x, pmf_eg2, support_eg2)</span></a>
<a class="sourceLine" id="cb15-33" title="33"><span class="co">    &gt;&gt;&gt; dfruit([&#39;apple&#39;, &#39;neither&#39;])</span></a>
<a class="sourceLine" id="cb15-34" title="34"><span class="co">    array([0.25, 0.35])</span></a>
<a class="sourceLine" id="cb15-35" title="35"><span class="co">    &gt;&gt;&gt; dfruit(&#39;orange&#39;)</span></a>
<a class="sourceLine" id="cb15-36" title="36"><span class="co">    0.4</span></a>
<a class="sourceLine" id="cb15-37" title="37"><span class="co">    &gt;&gt;&gt; dfruit(np.array([&#39;orange&#39;, &#39;hello&#39;]))</span></a>
<a class="sourceLine" id="cb15-38" title="38"><span class="co">    array([0.4, 0. ])</span></a>
<a class="sourceLine" id="cb15-39" title="39"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb15-40" title="40">    </a>
<a class="sourceLine" id="cb15-41" title="41">    M <span class="op">=</span> <span class="bu">len</span>(pmf_vec)</a>
<a class="sourceLine" id="cb15-42" title="42">    <span class="cf">if</span> support_vec <span class="kw">is</span> <span class="va">None</span>:</a>
<a class="sourceLine" id="cb15-43" title="43">        support_vec <span class="op">=</span> np.arange(<span class="dv">0</span>, M)</a>
<a class="sourceLine" id="cb15-44" title="44">    D <span class="op">=</span> {}</a>
<a class="sourceLine" id="cb15-45" title="45">    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(support_vec)):</a>
<a class="sourceLine" id="cb15-46" title="46">        D[support_vec[i]] <span class="op">=</span> pmf_vec[i]</a>
<a class="sourceLine" id="cb15-47" title="47">    finder <span class="op">=</span> <span class="kw">lambda</span> d: D[d] <span class="cf">if</span> d <span class="kw">in</span> D.keys() <span class="cf">else</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb15-48" title="48">    <span class="cf">if</span> <span class="bu">hasattr</span>(x, <span class="st">&#39;__iter__&#39;</span>):</a>
<a class="sourceLine" id="cb15-49" title="49">        <span class="cf">if</span> <span class="bu">type</span>(x) <span class="op">==</span> <span class="bu">str</span>:</a>
<a class="sourceLine" id="cb15-50" title="50">            <span class="cf">return</span> finder(x)</a>
<a class="sourceLine" id="cb15-51" title="51">        <span class="cf">return</span> npmap(finder, x)</a>
<a class="sourceLine" id="cb15-52" title="52">    <span class="cf">return</span> finder(x)</a></code></pre></div>
<p>And finally, <code>rpmf</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">def</span> rpmf(n, pmf, support, <span class="op">**</span>kwargs):</a>
<a class="sourceLine" id="cb16-2" title="2">    <span class="co">&#39;&#39;&#39;(int, function, *iterable[, **kwargs]) -&gt; np.array</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">    </span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">    Precondition: </span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co">    1. n &gt;= 1</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">    2. support is the support of pmf.</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">    </span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co">    Return n random samples from the specified pmf with support &#39;support&#39;</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">    and additional arguments of pmf in **kwargs if required. Since this</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">    function uses **kwargs, any additional arguments of pmf you want to</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="co">    specify must be named.</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">    </span></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co">    &gt;&gt;&gt; # Example 1: dX</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co">    &gt;&gt;&gt; np.random.seed(1024)</span></a>
<a class="sourceLine" id="cb16-15" title="15"><span class="co">    &gt;&gt;&gt; rpmf(n = 20, pmf = dX, support = np.arange(0, 6))</span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="co">    array([5, 5, 5, 5, 5, 5, 1, 0, 1, 5, 5, 5, 5, 3, 5, 5, 5, 2, 5, 1])</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="co">    &gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="co">    &gt;&gt;&gt; # Example 2: S_Y = Y_1 + ... + Y_N</span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="co">    &gt;&gt;&gt; np.random.seed(1024)</span></a>
<a class="sourceLine" id="cb16-20" title="20"><span class="co">    &gt;&gt;&gt; result_S_Y = csum_N(dY, np.arange(0, 5), 3) # in csum_N example</span></a>
<a class="sourceLine" id="cb16-21" title="21"><span class="co">    &gt;&gt;&gt; result_S_Y = result_S_Y / sum(result_S_Y)</span></a>
<a class="sourceLine" id="cb16-22" title="22"><span class="co">    &gt;&gt;&gt; M_S_Y = len(result_S_Y)</span></a>
<a class="sourceLine" id="cb16-23" title="23"><span class="co">    &gt;&gt;&gt; rpmf(10, dpmf, np.arange(0, M_S_Y), pmf_vec = result_S_Y)</span></a>
<a class="sourceLine" id="cb16-24" title="24"><span class="co">    array([ 8, 22,  6,  8,  7,  9,  2,  0,  2,  9])</span></a>
<a class="sourceLine" id="cb16-25" title="25"><span class="co">    &gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb16-26" title="26"><span class="co">    &gt;&gt;&gt; # Example 3: dfruit in dpmf example</span></a>
<a class="sourceLine" id="cb16-27" title="27"><span class="co">    &gt;&gt;&gt; np.random.seed(2048)</span></a>
<a class="sourceLine" id="cb16-28" title="28"><span class="co">    &gt;&gt;&gt; rpmf(7, dfruit, [&#39;apple&#39;, &#39;orange&#39;, &#39;neither&#39;])</span></a>
<a class="sourceLine" id="cb16-29" title="29"><span class="co">    array([&#39;orange&#39;, &#39;apple&#39;, &#39;neither&#39;, &#39;neither&#39;, &#39;neither&#39;, &#39;orange&#39;,</span></a>
<a class="sourceLine" id="cb16-30" title="30"><span class="co">           &#39;apple&#39;], dtype=&#39;&lt;U7&#39;)</span></a>
<a class="sourceLine" id="cb16-31" title="31"><span class="co">    &#39;&#39;&#39;</span></a>
<a class="sourceLine" id="cb16-32" title="32">    </a>
<a class="sourceLine" id="cb16-33" title="33">    cmf_vec <span class="op">=</span> np.append(<span class="dv">0</span>, np.cumsum(pmf(support, <span class="op">**</span>kwargs)))</a>
<a class="sourceLine" id="cb16-34" title="34">    unif_01 <span class="op">=</span> np.random.random(n)</a>
<a class="sourceLine" id="cb16-35" title="35">    result <span class="op">=</span> []</a>
<a class="sourceLine" id="cb16-36" title="36">    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n):</a>
<a class="sourceLine" id="cb16-37" title="37">        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cmf_vec) <span class="op">-</span> <span class="dv">1</span>):</a>
<a class="sourceLine" id="cb16-38" title="38">            <span class="cf">if</span> unif_01[k] <span class="op">&gt;=</span> cmf_vec[j] <span class="kw">and</span> unif_01[k] <span class="op">&lt;</span> cmf_vec[j <span class="op">+</span> <span class="dv">1</span>]:</a>
<a class="sourceLine" id="cb16-39" title="39">                result.append(support[j])</a>
<a class="sourceLine" id="cb16-40" title="40">    <span class="cf">return</span> np.array(result)</a></code></pre></div>
<p>As we did previously, let’s generate 10,000 samples of <span class="math inline">\(S = \sum_{i = 1}^{N} X_i\)</span> and draw the histogram:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb17-1" title="1">np.random.seed(<span class="dv">2048</span>)</a>
<a class="sourceLine" id="cb17-2" title="2">start_py <span class="op">=</span> dt.now()</a>
<a class="sourceLine" id="cb17-3" title="3">samples_N <span class="op">=</span> rpmf(<span class="dv">10000</span>, dpmf, np.arange(<span class="dv">0</span>, M), pmf_vec <span class="op">=</span> result)</a>
<a class="sourceLine" id="cb17-4" title="4">end_py <span class="op">=</span> dt.now()</a>
<a class="sourceLine" id="cb17-5" title="5">plt.clf()</a>
<a class="sourceLine" id="cb17-6" title="6">bins <span class="op">=</span> np.arange(<span class="op">-</span>.<span class="dv">5</span>, M <span class="op">+</span> <span class="fl">1.5</span>, step <span class="op">=</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-7" title="7">plt.hist(samples_N, bins <span class="op">=</span> bins, density <span class="op">=</span> <span class="va">True</span>)</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb18-1" title="1">plt.title(<span class="st">&#39;Histogram of S&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb19-1" title="1">plt.ylabel(<span class="st">&#39;Mass&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb20-1" title="1">plt.xlabel(<span class="st">&#39;x&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb21-1" title="1">plt.show()</a></code></pre></div>
<p><img src="pgf_python_files/figure-html/histogram-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To compare the histogram and the actual pmf, we superimpose two plots as follows:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb22-1" title="1">plt.clf()</a>
<a class="sourceLine" id="cb22-2" title="2">plt.scatter(np.arange(<span class="dv">0</span>, M), result, s <span class="op">=</span> <span class="dv">5</span>, c <span class="op">=</span> <span class="st">&#39;black&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb23-1" title="1">plt.hist(samples_N, bins <span class="op">=</span> bins, density <span class="op">=</span> <span class="va">True</span>, alpha <span class="op">=</span> <span class="fl">.5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb24-1" title="1">plt.title(<span class="st">&#39;Histogram vs. the actual pmf of S&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb25-1" title="1">plt.ylabel(<span class="st">&#39;Mass&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb26-1" title="1">plt.xlabel(<span class="st">&#39;x&#39;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb27-1" title="1">plt.show()</a></code></pre></div>
<p><img src="pgf_python_files/figure-html/superimposing-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="rpmf-comparison-with-its-r-equivalent" class="section level2">
<h2><code>rpmf</code> comparison with its R equivalent</h2>
<p>It takes</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb28-1" title="1"><span class="bu">str</span>(end_py <span class="op">-</span> start_py)</a></code></pre></div>
<pre><code>## &#39;0:00:00.833220&#39;</code></pre>
<p>seconds to generate 10,000 samples of <span class="math inline">\(S = \sum_{i = 1}^{N} X_i\)</span>. In R, it takes:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">set.seed</span>(<span class="dv">2048</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">start_r &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</a>
<a class="sourceLine" id="cb30-3" title="3">samples_N &lt;-<span class="st"> </span><span class="kw">rpmf</span>(<span class="dv">10000</span>, dpmf, <span class="dv">0</span><span class="op">:</span>(M <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), result)</a>
<a class="sourceLine" id="cb30-4" title="4">end_r &lt;-<span class="st"> </span><span class="kw">Sys.time</span>()</a>
<a class="sourceLine" id="cb30-5" title="5">end_r <span class="op">-</span><span class="st"> </span>start_r</a></code></pre></div>
<pre><code>## Time difference of 25.58828 secs</code></pre>
<p>Unlike what happened in <a href="../2019/em_imputation_python.html">Imputation using EM: Python implementation</a>, Python is significantly faster than R this time. It is evident that a nested for-loop in R, or for-loop in general, is slower than in Python.</p>
<p>You can download the Python script for these functions <a href="../../files/pgf.py">here</a>. Examples within docstrings are tested with <code>doctest</code> framework.</p>
</div>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<p>R session info:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 18362)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_Canada.1252 
## [2] LC_CTYPE=English_Canada.1252   
## [3] LC_MONETARY=English_Canada.1252
## [4] LC_NUMERIC=C                   
## [5] LC_TIME=English_Canada.1252    
## 
## attached base packages:
## [1] stats     graphics 
## [3] grDevices utils    
## [5] datasets  methods  
## [7] base     
## 
## other attached packages:
##  [1] dplyr_0.8.3      
##  [2] reticulate_1.13  
##  [3] pROC_1.15.3      
##  [4] ggrepel_0.8.1    
##  [5] ggplot2_3.2.1    
##  [6] funpark_0.2.6    
##  [7] data.table_1.12.6
##  [8] boot_1.3-22      
##  [9] rmarkdown_1.17   
## [10] magrittr_1.5     
## [11] itertools2_0.1.1 
## 
## loaded via a namespace (and not attached):
##  [1] prettydoc_0.3.1 
##  [2] tidyselect_0.2.5
##  [3] xfun_0.11       
##  [4] purrr_0.3.3     
##  [5] lattice_0.20-38 
##  [6] colorspace_1.4-1
##  [7] vctrs_0.2.0     
##  [8] htmltools_0.4.0 
##  [9] yaml_2.2.0      
## [10] utf8_1.1.4      
## [11] rlang_0.4.2     
## [12] pillar_1.4.2    
## [13] glue_1.3.1      
## [14] withr_2.1.2     
## [15] lifecycle_0.1.0 
## [16] plyr_1.8.4      
## [17] stringr_1.4.0   
## [18] munsell_0.5.0   
## [19] gtable_0.3.0    
## [20] evaluate_0.14   
## [21] labeling_0.3    
## [22] knitr_1.26      
## [23] fansi_0.4.0     
## [24] Rcpp_1.0.3      
## [25] readr_1.3.1     
## [26] scales_1.1.0    
## [27] backports_1.1.5 
## [28] jsonlite_1.6    
## [29] farver_2.0.1    
## [30] png_0.1-7       
## [31] hms_0.5.2       
## [32] digest_0.6.23   
## [33] stringi_1.4.3   
## [34] grid_3.6.1      
## [35] cli_1.1.0       
## [36] tools_3.6.1     
## [37] lazyeval_0.2.2  
## [38] tibble_2.1.3    
## [39] crayon_1.3.4    
## [40] tidyr_1.0.0     
## [41] pkgconfig_2.0.3 
## [42] zeallot_0.1.0   
## [43] ellipsis_0.3.0  
## [44] Matrix_1.2-17   
## [45] xml2_1.2.2      
## [46] assertthat_0.2.1
## [47] rstudioapi_0.10 
## [48] iterators_1.0.12
## [49] R6_2.4.1        
## [50] compiler_3.6.1</code></pre>
<p>Python session info:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb34-1" title="1"><span class="im">import</span> sinfo</a>
<a class="sourceLine" id="cb34-2" title="2">sinfo.sinfo()</a></code></pre></div>
<pre><code>## -----
## matplotlib   3.1.1
## numpy        1.17.0
## scipy        1.1.0
## -----
## Python 3.7.2 (tags/v3.7.2:9a3ffc0492, Dec 23 2018, 23:09:28) [MSC v.1916 64 bit (AMD64)]
## Windows-10-10.0.18362-SP0
## 4 logical CPU cores, Intel64 Family 6 Model 78 Stepping 3, GenuineIntel
## -----
## Session information updated at 2020-01-12 22:46</code></pre>
</div>
<div id="related-pages" class="section level1">
<h1>Related pages</h1>
<ul>
<li><a href="pgf.html">Evaluating a hard-to-evaluate pmf using pgf and DFT</a></li>
<li><a href="../2019/em_imputation_python.html">Imputation using EM: Python implementation</a></li>
</ul>
</div>
</section>

<!-- Footer -->
<!-- Reference: https://holtzy.github.io/Pimp-my-rmd/ -->
&nbsp; <!-- whitespace -->
<hr /> <!-- line -->
<div class="footer">
    <p style="text-align: center;">
        <a href="../../index.html" style="font-size: 11pt;">Home</a> · <a href="../../projects.html" style="font-size: 11pt;">Projects</a> · <a href="../../research_materials.html" style="font-size: 11pt;">Research materials</a> · <a href="../../files/resume_junkyu_park.pdf" style="font-size: 11pt;">Resume</a>
    </p>
    <p style="text-align: center;">
        © 2019-2020 Junkyu Park<br>Powered by the <a href="https://github.com/yixuan/prettydoc">prettydoc::html_pretty</a> engine<br>Current theme: modified <a href="https://github.com/jasonlong/cayman-theme">Cayman</a>
    </p>
            
    <!-- Add icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
            
    <!-- Add font awesome icons -->
    <p style="text-align: center; margin: 5px 0;">
        <span style="color: #555555;"><em>joon3216@gmail.com</em></span>
        <br>
        <ul class="social-network">
            <li class="button"><a href="https://www.facebook.com/asdfzxcvjkl1" class="fa fa-facebook"></a></li>
            <li class="button"><a href="https://github.com/joon3216" class="fa fa-github"></a></li>
            <li class="button"><a href="https://linkedin.com/in/asdfzxcvjkl1/" class="fa fa-linkedin"></a></li>
            <li class="button"><a href="https://twitter.com/joon3216" class="fa fa-twitter"></a></li>
        </ul>
    </p>
</div>
&nbsp; <!-- whitespace -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
