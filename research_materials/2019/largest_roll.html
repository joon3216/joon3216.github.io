<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Junkyu Park" />


<title>Animation in R: the largest value until the current roll</title>

<link href="largest_roll_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="largest_roll_files/pagedtable-1.1/js/pagedtable.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-139050237-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-139050237-1');
</script>
<!-- A new navigation bar style settings -->
<style type="text/css">
body
{
    margin: 0;
    padding: 0;
    font-family: sans-serif;
}
/* at the top */
header
{
    position: sticky;
    top: 0;
    left: 0;
    padding: 10px 25px;
    background: rgba(28, 44, 56, 0.99);
    width: 100%;
    height: 50px;
    box-sizing: border-box;
    border-bottom: 1px solid #EAEAEB;
    transition: .5s;
}
header .logo
{
    float: left;
}
header .logo img
{
    height: 30px;
}
header nav
{
    float: left;
}
header nav ul
{
    margin: 0;
    padding: 0;
    display: flex;

}
header nav ul li
{
    padding: 0;
    list-style: none;
    position: relative;
}
header nav ul li.sub-menu:before
{
    content: '▼'; /* &#9660 nabla */
    font-size: 16pt;
    font-family: sans-serif;
    position: absolute;
    line-height: 30px;
    color: #ffffff;
    top: -1pt;
    right: -2px;
    cursor: pointer;
}
header nav ul li.active.sub-menu:before
{
    content: '▲';  /* &#9650 Delta */
    font-size: 16pt;
    top: -1pt;
    right: -2px;
    cursor: pointer;
}
header nav ul li ul
{
    position: absolute;
    left: 0;
    top: 40px; /* controls the box position of 2018 and 2019 under Research materials */
    background: rgba(57, 143, 209, 0.99);
    display: none;
}
header nav ul li.active ul
{
    display: block;
}
header nav ul li ul li
{
    display: block;
    width: 200px;
}
header nav ul li a
{
    height: 30px;
    line-height: 30px;
    padding: 0; /* old: 0 20px; why change: to make text the only clickable object */
    margin: 0 20px;
    color: #ffffff;
    text-decoration: none;
    /*display: block;*/
}
/* new: news; why add: to make News go to the right */
header nav ul li.sub-menu2
{
    margin: 0 0 0 20px;
}
header nav ul li a:hover
{
    color: #ffffff;
}
.menu-toggle
{
    color: #ffffff;
    float: right;
    line-height: 30px;
    font-size: 24px;
    cursor: pointer;
    display: none;
}
@media (max-width: 800px) /* old: 991px 721px */
{
    /* at the top */
    header
    {
        padding: 10px 25px;
    }
    .menu-toggle
    {
        display: block;
    }
    header nav
    {
        /*display: none;*/
        position: absolute;
        width: 100%;
        height: calc(100vh - 50px);
        background: rgba(28, 44, 56, 0.99);
        top: 50px;
        left: -100%;
        transition: .5s;
    }
    header nav.active
    {
        left: 0;
    }
    header nav ul
    {
        display: block;
        /*text-align: center;*/
    }
    header nav ul li a
    {
        border-bottom: 1px solid rgba(255, 255, 255, .5);
        height: 50px;
        line-height: 50px;
        padding: 0 20px;
    }
    header nav ul li.active ul
    {
        position: relative;
    }
    header nav ul li ul li
    {
        width: 100%;
    }
    header nav ul li.sub-menu:before
    {
        content: '+'; /* old: &#9660 nabla */
        font-size: 20pt;
        font-family: sans-serif;
        position: absolute;
        line-height: 30px;
        color: #ffffff;
        top: 5pt;
        right: 25px;
        cursor: pointer;
    }
    header nav ul li.active.sub-menu:before
    {
        content: '-';  /* new: &#9650 Delta */
        font-size: 24pt;
        top: 5pt;
        right: 25px;
        cursor: pointer;
    }
    header nav ul li ul
    {
        position: absolute;
        left: 0;
        top: 0px; /* controls the box position of 2018 and 2019 under Research materials */
        background: rgba(57, 143, 209, 0.99);
        display: none;
    }
    /* new: News; why: to make News align with the others in mobile */
    header nav ul li.sub-menu2
    {
        margin: 0;
    }

    /* while scrolling */

}

/* while scrolling */
header.black
{
    background: rgba(21, 92, 148, .7);
}
</style>

<!-- Navigation bar color change as one scrolls -->
<script src="https://code.jquery.com/jquery-3.2.1.js"></script>
<script type="text/javascript">
    $(window).on('scroll', function(){
        if ($(window).scrollTop()){
            $('header').addClass('black');
        }
        else
        {
            $('header').removeClass('black');
        }
    })
</script>

<!-- Navigation bar slide from the left in mobile -->
<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        $('.menu-toggle').click(function(){
            $('nav').toggleClass('active')
        })
        $('ul li').click(function(){
            $(this).siblings().removeClass('active');
            $(this).toggleClass('active');
        })
    })
</script>
<link rel="icon" href="../../style/all_orange_jp.png">


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link rel="stylesheet" href="largest_roll_files/style.css" type="text/css" />

</head>

<body>


<!-- A new navigation bar -->
<header>
    <div class="logo"><a href="../../index.html"><img src="../../style/all_orange_jp.png"></a></div>
    <nav>
        <ul>
            <li><a href="../../cv.html">About</a></li>
            <li><a href="../../projects.html">Projects</a></li>
            <li class="sub-menu"><a href="../../research_materials.html">Research materials</a>
                <ul>
                    <li><a href="../../research_materials/2018.html">2018</a></li>
                    <li><a href="../../research_materials/2019.html">2019</a></li>
                </ul>
            </li>
            <li class="sub-menu2"><a href="../../news.html">News</a></li>
        </ul>
    </nav>
    <div class="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></div>
</header>


<section class="page-header">
<h1 class="title toc-ignore project-name">Animation in R:<br>the largest value until the current roll</h1>
<h4 class="author project-author">Junkyu Park</h4>
</section>


<div id="TOC" class="toc">
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#the-largest-roll-until-now">2. The largest roll until now</a></li>
<li><a href="#session-info">Session info</a></li>
</ul>
</div>

<section class="main-content">
<p>The following external R packages are used:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(gganimate)
gather &lt;-<span class="st"> </span>tidyr<span class="op">::</span>gather</code></pre></div>
<div id="introduction" class="section level1">
<h1>1. Introduction</h1>
<p>This is to illustrate changes in marginal probabilities of the “largest value until the current die roll” Markov chain <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> using <code>gganimate</code> package.</p>
</div>
<div id="the-largest-roll-until-now" class="section level1">
<h1>2. The largest roll until now</h1>
<p>Say you’re rolling a fair six-sided die. Let <span class="math inline">\(X_0\)</span> be <span class="math inline">\(0\)</span>, and <span class="math inline">\(X_n\)</span> be the largest value that appears among all of the rolls up to time <span class="math inline">\(n \geq 1 \text{ }\)</span><sup><a href="largest_roll.html#fn1">1</a></sup>. Clearly, the state space is <span class="math inline">\(S = \{0, 1, 2, 3, 4, 5, 6 \}\)</span> with initial probabilities <span class="math inline">\(v_0 = P(X_0 = 0) = 1\)</span>, <span class="math inline">\(v_s = 0\)</span> for all <span class="math inline">\(s \in S - \{ 0 \}\)</span>, and: <span class="math display">\[p_{0j} = P(X_{n} = j \text{ | } X_{n - 1} = 0) = \frac{1}{6} \text{ } \forall j \in S - \{ 0\}\]</span></p>
<p>One fact you can see is that <span class="math inline">\(X_n\)</span> never decreases by definition, i.e. <span class="math inline">\(X_{n - 1} \leq X_n\)</span> for <span class="math inline">\(n \geq 1\)</span>. And since we are tossing a fair die, the marginal probability of seeing either side is the same across all sides. So, for example, if <span class="math inline">\(X_n\)</span> is <span class="math inline">\(4\)</span>, and <span class="math inline">\(Y_{n + 1}\)</span> is the value that appears at the <span class="math inline">\((n + 1)\)</span><sup>th</sup> roll, then since <span class="math inline">\(P(Y_{n + 1} = i) = \frac{1}{6}\)</span> for all <span class="math inline">\(i \in S - \{ 0 \}\)</span>, we obtain:</p>
<span class="math display">\[\begin{align*}
p_{44} &amp;= P(X_{n + 1} = 4 \text{ | } X_n = 4) = P(Y_{n + 1} \leq 4) = \frac{4}{6} \\
p_{45} &amp;= P(X_{n + 1} = 5 \text{ | } X_n = 4) = P(Y_{n + 1} = 5) = \frac{1}{6} \\
&amp;= p_{46}
\end{align*}\]</span>
<p>That is, if <span class="math inline">\(1, 2, 3,\)</span> or <span class="math inline">\(4\)</span> shows up at the <span class="math inline">\((n + 1)\)</span><sup>th</sup> roll, then the current maximum <span class="math inline">\(X_{n + 1}\)</span> is still <span class="math inline">\(4\)</span>. Using the same argument for all <span class="math inline">\(i, j \in S\)</span>, we get: <span class="math display">\[p_{ij} = \begin{cases} \frac{j}{6} &amp; i = j \\ \frac{1}{6} &amp; i &lt; j \\ 0 &amp; i &gt; j \end{cases}\]</span></p>
<p>Say <span class="math inline">\(P_{7 \times 7}\)</span> is the matrix of transition probabilities. Then it should be: <span class="math display">\[P_{7 \times 7} = \big[p_{ij} \big]_{i = 0:6, j = 0:6}= \begin{bmatrix} 0 &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} \\ 0 &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} \\ 0 &amp; 0 &amp; \frac{2}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} \\ 0 &amp; 0 &amp; 0 &amp; \frac{3}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} &amp; \frac{1}{6} \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{4}{6} &amp;  \frac{1}{6}&amp; \frac{1}{6} \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{5}{6} &amp; \frac{1}{6} \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \end{bmatrix}\]</span></p>
<p>My goal is to visualize the change in marginal probabilities <span class="math inline">\(P(X_n = i)\)</span>, <span class="math inline">\(i \in S\)</span>, as <span class="math inline">\(n \to \infty\)</span>. I will define <span class="math inline">\(P\)</span>-matrix, and set 50 as the maximum <span class="math inline">\(n\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Settings</span>
max_n &lt;-<span class="st"> </span><span class="dv">50</span>
v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">6</span>)) <span class="co"># initial probabilities v_0, v_1, ..., v_6</span>

<span class="co"># P matrix</span>
P &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">6</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) {
    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) {
        <span class="cf">if</span> (i <span class="op">&lt;</span><span class="st"> </span>j) {
            P[i, j] &lt;-<span class="st"> </span><span class="dv">1</span>
        }
    }
}
(P &lt;-<span class="st"> </span>P <span class="op">/</span><span class="st"> </span><span class="dv">6</span>)</code></pre></div>
<pre><code>##      [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
## [1,]    0 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667
## [2,]    0 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667
## [3,]    0 0.0000000 0.3333333 0.1666667 0.1666667 0.1666667 0.1666667
## [4,]    0 0.0000000 0.0000000 0.5000000 0.1666667 0.1666667 0.1666667
## [5,]    0 0.0000000 0.0000000 0.0000000 0.6666667 0.1666667 0.1666667
## [6,]    0 0.0000000 0.0000000 0.0000000 0.0000000 0.8333333 0.1666667
## [7,]    0 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000</code></pre>
<p>Say <span class="math inline">\(P^k = P^{(k)}\)</span> stores <span class="math inline">\(p_{ij}^{(k)} = P(X_{n + k} = j \text{ | } X_n = i)\)</span>, i.e. the probability that <span class="math inline">\(j\)</span> will be the maximum after throwing a die exactly <span class="math inline">\(k\)</span> times given the current maximum of <span class="math inline">\(i\)</span>. Also, say <span class="math inline">\(\mu_k\)</span> is the (row) vector of all <span class="math inline">\(P(X_k = i)\)</span>’s, <span class="math inline">\(i \in S\)</span>. Then given a vector of initial probabilities <span class="math inline">\(v = \begin{bmatrix} v_0 &amp; v_1 &amp; \dots &amp; v_6 \end{bmatrix}_{1 \times 7}\)</span>: <span class="math display">\[\mu_k = v P^k\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Pk &lt;-<span class="st"> </span><span class="cf">function</span>(P, k) {
    <span class="co"># P: a numeric matrix</span>
    <span class="co"># k: a natural number</span>
    
    lst_k &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&#39;list&#39;</span>, k)
    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {
        lst_k[[i]] &lt;-<span class="st"> </span>P
    }
    <span class="kw">Reduce</span>(<span class="st">&#39;%*%&#39;</span>, lst_k)
}
mu_k &lt;-<span class="st"> </span><span class="cf">function</span>(v, P, k) {<span class="kw">t</span>(v) <span class="op">%*%</span><span class="st"> </span><span class="kw">Pk</span>(P, k)}</code></pre></div>
<p>Each row of <code>mu_collection</code> consists of <span class="math inline">\(n\)</span> and <span class="math inline">\(\mu_n\)</span>, in this order, <span class="math inline">\(n = 0, 1, \dots, 50\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(mu_collection &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw">t</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>max_n, <span class="cf">function</span>(k){<span class="kw">mu_k</span>(v, P, k)})) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">rbind</span>(v, .) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">cbind</span>(<span class="dv">0</span><span class="op">:</span>max_n, .) <span class="op">%&gt;%</span>
<span class="st">    &#39;colnames&lt;-&#39;</span>(<span class="kw">c</span>(<span class="st">&#39;n&#39;</span>, <span class="dv">0</span><span class="op">:</span><span class="dv">6</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">as_tibble</span>())</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["0"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["1"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["3"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["4"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["5"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["6"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"1","3":"0.000000e+00","4":"0.000000e+00","5":"0.000000e+00","6":"0.000000e+00","7":"0.0000000000","8":"0.0000000"},{"1":"1","2":"0","3":"1.666667e-01","4":"1.666667e-01","5":"1.666667e-01","6":"1.666667e-01","7":"0.1666666667","8":"0.1666667"},{"1":"2","2":"0","3":"2.777778e-02","4":"8.333333e-02","5":"1.388889e-01","6":"1.944444e-01","7":"0.2500000000","8":"0.3055556"},{"1":"3","2":"0","3":"4.629630e-03","4":"3.240741e-02","5":"8.796296e-02","6":"1.712963e-01","7":"0.2824074074","8":"0.4212963"},{"1":"4","2":"0","3":"7.716049e-04","4":"1.157407e-02","5":"5.015432e-02","6":"1.350309e-01","7":"0.2847222222","8":"0.5177469"},{"1":"5","2":"0","3":"1.286008e-04","4":"3.986626e-03","5":"2.713477e-02","6":"1.004372e-01","7":"0.2701903292","8":"0.5981224"},{"1":"6","2":"0","3":"2.143347e-05","4":"1.350309e-03","5":"1.425326e-02","6":"7.216650e-02","7":"0.2471064815","8":"0.6651020"},{"1":"7","2":"0","3":"3.572245e-06","4":"4.536751e-04","5":"7.355253e-03","6":"5.071516e-02","7":"0.2205539838","8":"0.7209184"},{"1":"8","2":"0","3":"5.953742e-07","4":"1.518204e-04","5":"3.753834e-03","6":"3.511219e-02","7":"0.1935495971","8":"0.7674320"},{"1":"9","2":"0","3":"9.922903e-08","4":"5.070603e-05","5":"1.902320e-03","6":"2.405917e-02","7":"0.1677944046","8":"0.8061933"},{"1":"10","2":"0","3":"1.653817e-08","4":"1.691855e-05","5":"9.596274e-04","6":"1.636497e-02","7":"0.1441640530","8":"0.8384944"},{"1":"11","2":"0","3":"2.756362e-09","4":"5.642273e-06","5":"4.826362e-04","6":"1.107274e-02","7":"0.1230269658","8":"0.8654120"},{"1":"12","2":"0","3":"4.593937e-10","4":"1.881217e-06","5":"2.422589e-04","6":"7.463206e-03","7":"0.1044493082","8":"0.8878433"},{"1":"13","2":"0","3":"7.656561e-11","4":"6.271489e-07","5":"1.214431e-04","6":"5.016161e-03","7":"0.0883256479","8":"0.9065361"},{"1":"14","2":"0","3":"1.276093e-11","4":"2.090624e-07","5":"6.082608e-05","6":"3.364452e-03","7":"0.0744610784","8":"0.9221134"},{"1":"15","2":"0","3":"2.126822e-12","4":"6.968959e-08","5":"3.044789e-05","6":"2.253141e-03","7":"0.0626218133","8":"0.9350945"},{"1":"16","2":"0","3":"3.544704e-13","4":"2.323022e-08","5":"1.523556e-05","6":"1.507180e-03","7":"0.0525654541","8":"0.9459121"},{"1":"17","2":"0","3":"5.907840e-14","4":"7.743465e-09","5":"7.621651e-06","6":"1.007330e-03","7":"0.0440582849","8":"0.9549268"},{"1":"18","2":"0","3":"9.846400e-15","4":"2.581165e-09","5":"3.812116e-06","6":"6.728248e-04","7":"0.0368843973","8":"0.9624390"},{"1":"19","2":"0","3":"1.641067e-15","4":"8.603900e-10","5":"1.906488e-06","6":"4.491856e-04","7":"0.0308497710","8":"0.9686991"},{"1":"20","2":"0","3":"2.735111e-16","4":"2.867969e-10","5":"9.533875e-07","6":"2.997750e-04","7":"0.0257833246","8":"0.9739159"},{"1":"21","2":"0","3":"4.558519e-17","4":"9.559902e-11","5":"4.767416e-07","6":"2.000089e-04","7":"0.0215362253","8":"0.9782633"},{"1":"22","2":"0","3":"7.597531e-18","4":"3.186635e-11","5":"2.383867e-07","6":"1.334188e-04","7":"0.0179802687","8":"0.9818861"},{"1":"23","2":"0","3":"1.266255e-18","4":"1.062212e-11","5":"1.191987e-07","6":"8.898558e-05","7":"0.0150058335","8":"0.9849051"},{"1":"24","2":"0","3":"2.110425e-19","4":"3.540706e-12","5":"5.960110e-08","6":"5.934359e-05","7":"0.0125197120","8":"0.9874209"},{"1":"25","2":"0","3":"3.517376e-20","4":"1.180235e-12","5":"2.980114e-08","6":"3.957233e-05","7":"0.0104429939","8":"0.9895174"},{"1":"26","2":"0","3":"5.862293e-21","4":"3.934118e-13","5":"1.490077e-08","6":"2.638652e-05","7":"0.0087090953","8":"0.9912645"},{"1":"27","2":"0","3":"9.770488e-22","4":"1.311373e-13","5":"7.450449e-09","6":"1.759350e-05","7":"0.0072619796","8":"0.9927204"},{"1":"28","2":"0","3":"1.628415e-22","4":"4.371242e-14","5":"3.725247e-09","6":"1.173024e-05","7":"0.0060545832","8":"0.9939337"},{"1":"29","2":"0","3":"2.714024e-23","4":"1.457081e-14","5":"1.862631e-09","6":"7.820780e-06","7":"0.0050474416","8":"0.9949447"},{"1":"30","2":"0","3":"4.523374e-24","4":"4.856936e-15","5":"9.313177e-10","6":"5.214164e-06","7":"0.0042075051","8":"0.9957873"},{"1":"31","2":"0","3":"7.538957e-25","4":"1.618979e-15","5":"4.656597e-10","6":"3.476264e-06","7":"0.0035071235","8":"0.9964894"},{"1":"32","2":"0","3":"1.256493e-25","4":"5.396595e-16","5":"2.328301e-10","6":"2.317587e-06","7":"0.0029231823","8":"0.9970745"},{"1":"33","2":"0","3":"2.094155e-26","4":"1.798865e-16","5":"1.164151e-10","6":"1.545097e-06","7":"0.0024363716","8":"0.9975621"},{"1":"34","2":"0","3":"3.490258e-27","4":"5.996217e-17","5":"5.820760e-11","6":"1.030084e-06","7":"0.0020305672","8":"0.9979684"},{"1":"35","2":"0","3":"5.817096e-28","4":"1.998739e-17","5":"2.910381e-11","6":"6.867324e-07","7":"0.0016923110","8":"0.9983070"},{"1":"36","2":"0","3":"9.695160e-29","4":"6.662463e-18","5":"1.455191e-11","6":"4.578264e-07","7":"0.0014103736","8":"0.9985892"},{"1":"37","2":"0","3":"1.615860e-29","4":"2.220821e-18","5":"7.275955e-12","6":"3.052201e-07","7":"0.0011753877","8":"0.9988243"},{"1":"38","2":"0","3":"2.693100e-30","4":"7.402737e-19","5":"3.637978e-12","6":"2.034812e-07","7":"0.0009795406","8":"0.9990203"},{"1":"39","2":"0","3":"4.488500e-31","4":"2.467579e-19","5":"1.818989e-12","6":"1.356548e-07","7":"0.0008163177","8":"0.9991835"},{"1":"40","2":"0","3":"7.480833e-32","4":"8.225263e-20","5":"9.094946e-13","6":"9.043682e-08","7":"0.0006802874","8":"0.9993196"},{"1":"41","2":"0","3":"1.246806e-32","4":"2.741754e-20","5":"4.547473e-13","6":"6.029136e-08","7":"0.0005669212","8":"0.9994330"},{"1":"42","2":"0","3":"2.078009e-33","4":"9.139181e-21","5":"2.273737e-13","6":"4.019432e-08","7":"0.0004724444","8":"0.9995275"},{"1":"43","2":"0","3":"3.463349e-34","4":"3.046394e-21","5":"1.136868e-13","6":"2.679625e-08","7":"0.0003937104","8":"0.9996063"},{"1":"44","2":"0","3":"5.772248e-35","4":"1.015465e-21","5":"5.684342e-14","6":"1.786419e-08","7":"0.0003280964","8":"0.9996719"},{"1":"45","2":"0","3":"9.620413e-36","4":"3.384882e-22","5":"2.842171e-14","6":"1.190947e-08","7":"0.0002734167","8":"0.9997266"},{"1":"46","2":"0","3":"1.603402e-36","4":"1.128294e-22","5":"1.421085e-14","6":"7.939649e-09","7":"0.0002278492","8":"0.9997721"},{"1":"47","2":"0","3":"2.672337e-37","4":"3.760980e-23","5":"7.105427e-15","6":"5.293102e-09","7":"0.0001898757","8":"0.9998101"},{"1":"48","2":"0","3":"4.453895e-38","4":"1.253660e-23","5":"3.552714e-15","6":"3.528736e-09","7":"0.0001582306","8":"0.9998418"},{"1":"49","2":"0","3":"7.423158e-39","4":"4.178867e-24","5":"1.776357e-15","6":"2.352491e-09","7":"0.0001318594","8":"0.9998681"},{"1":"50","2":"0","3":"1.237193e-39","4":"1.392956e-24","5":"8.881784e-16","6":"1.568328e-09","7":"0.0001098833","8":"0.9998901"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>It makes sense to see <span class="math inline">\(P(X_n = 6) \to 1\)</span> as <span class="math inline">\(n\)</span> increases. Now we should manipulate <code>mu_collection</code> so that it is ready for plotting a barplot of marginal probabilities at each <span class="math inline">\(n\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu_tidy &lt;-<span class="st"> </span>mu_collection <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(key, value, <span class="op">-</span>n)</code></pre></div>
<p>And here’s how marginal probabilities evolve as <span class="math inline">\(n \to \infty\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">anim &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mu_tidy, <span class="kw">aes</span>(<span class="dt">x =</span> key, <span class="dt">y =</span> value)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Eye&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Probability&#39;</span>, <span class="dt">title =</span> <span class="st">&quot;n: {closest_state}&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">transition_states</span>(n) <span class="op">+</span>
<span class="st">    </span><span class="kw">enter_fade</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">exit_fade</span>()
<span class="kw">animate</span>(
    anim,
    <span class="dt">fps =</span> <span class="dv">30</span>, <span class="dt">duration =</span> <span class="dv">30</span>,
    <span class="dt">start_pause =</span> <span class="dv">5</span>,
    <span class="dt">end_pause =</span> <span class="dv">5</span>
)</code></pre></div>
<p><img src="largest_roll.gif" style="display: block; margin: auto;" /></p>
<p>Indeed, <span class="math inline">\(P(X_n = 6) \stackrel{p}{\to} 1\)</span>.</p>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<p>R session info:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.6.0 (2019-04-26)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 17763)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_Canada.1252  LC_CTYPE=English_Canada.1252   
## [3] LC_MONETARY=English_Canada.1252 LC_NUMERIC=C                   
## [5] LC_TIME=English_Canada.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] gganimate_1.0.3 ggplot2_3.1.1   dplyr_0.8.1    
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.1        pillar_1.4.0      compiler_3.6.0   
##  [4] plyr_1.8.4        prettyunits_1.0.2 prettydoc_0.2.1  
##  [7] tools_3.6.0       progress_1.2.2    digest_0.6.18    
## [10] jsonlite_1.6      evaluate_0.13     tibble_2.1.1     
## [13] gtable_0.3.0      pkgconfig_2.0.2   rlang_0.3.4      
## [16] yaml_2.2.0        xfun_0.7          withr_2.1.2      
## [19] stringr_1.4.0     knitr_1.23        hms_0.4.2        
## [22] grid_3.6.0        tidyselect_0.2.5  glue_1.3.1       
## [25] R6_2.4.0          rmarkdown_1.12    purrr_0.3.2      
## [28] tweenr_1.0.1      farver_1.1.0      tidyr_0.8.3      
## [31] magrittr_1.5      scales_1.0.0      htmltools_0.3.6  
## [34] assertthat_0.2.1  colorspace_1.4-1  stringi_1.4.3    
## [37] lazyeval_0.2.2    munsell_0.5.0     crayon_1.3.4</code></pre>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Rosenthal, J. (2019, April 05). STA447/2006 (Stochastic Processes) Lecture Notes, Winter 2019. Retrieved May 23, 2019, from <a href="http://probability.ca/jeff/teaching/1819/sta447/notes.pdf" class="uri">http://probability.ca/jeff/teaching/1819/sta447/notes.pdf</a><a href="#fnref1">↩</a></p></li>
</ol>
</div>
</section>

<!-- Footer -->
<!-- Reference: https://holtzy.github.io/Pimp-my-rmd/ -->
&nbsp; <!-- whitespace -->
<hr /> <!-- line -->
<p style="text-align: center;">written by <a href="https://github.com/joon3216">Junkyu Park</a></p>
<p style="text-align: center;"><span style="color: #555555;"><em>joon3216@gmail.com</em></span></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://www.facebook.com/asdfzxcvjkl1" class="fa fa-facebook"></a>
    <a href="https://github.com/joon3216" class="fa fa-github"></a>
    <a href="https://linkedin.com/in/asdfzxcvjkl1/" class="fa fa-linkedin"></a>
</p>
&nbsp; <!-- whitespace -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
